/* This file is part of BitPunch Copyright (C) 2016 Pavol Dobrocka <pavol.dobrocka[what here]gmail.com> This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details. You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. */#ifndef SIGCTX_H#define SIGCTX_H#include <stdint.h>#include <bitpunch/config.h>#include <bitpunch/math/gf2.h>#include <bitpunch/code/codectx.h>#include <bitpunch/crypto/signature/ldgm/ldgmsigtype.h>typedef enum _BPU_T_EN_Signature_Types {  BPU_EN_SIGN_LDGM} BPU_T_EN_Signature_Types;typedef enum _BPU_T_EN_Signature_Verification_Result_Type {  BPU_EN_SIG_ACCEPT, BPU_EN_SIG_DISCARD} BPU_T_EN_Signature_Verification_Result_Type;typedef union _BPU_T_UN_Signature {  BPU_T_LDGM_Signature* ldgm;} BPU_T_UN_Signature;typedef union _BPU_T_UN_Signature_Params {  BPU_T_LDGM_Params *ldgm;} BPU_T_UN_Signature_Params;typedef struct _BPU_T_Signature_Ctx {  BPU_T_EN_Signature_Types type;  int (*_sign)(BPU_T_UN_Signature *signature, const BPU_T_GF2_Vector *message, const struct _BPU_T_Signature_Ctx *ctx);  int (*_verify)(BPU_T_EN_Signature_Verification_Result_Type* result, BPU_T_GF2_Vector *message, const BPU_T_UN_Signature *signature,      const struct _BPU_T_Signature_Ctx *ctx);  int (*_genKeyPair)(const struct _BPU_T_Signature_Ctx *sig_ctx);  BPU_T_Code_Ctx *code_ctx;  BPU_T_UN_Signature_Params *params;} BPU_T_Signature_Ctx;int BPU_signatureInitCtx(BPU_T_Signature_Ctx **ctx, const BPU_T_UN_Signature_Params *params, const BPU_T_EN_Signature_Types type);void BPU_signatureFreeCtx(BPU_T_Signature_Ctx **ctx);int BPU_signatureKeyGen(BPU_T_Signature_Ctx **ctx);int BPU_signatureSign(BPU_T_Signature_Ctx **ctx, BPU_T_UN_Signature *signature, const BPU_T_GF2_Vector *message);int BPU_signatureVerify(BPU_T_Signature_Ctx **ctx, BPU_T_EN_Signature_Verification_Result_Type* result, BPU_T_GF2_Vector *message,    const BPU_T_UN_Signature *signature);#endif // SIGCTX_H